/*
by F0x - Mateus Tesser
*/
console.log("----------------------");
console.log('> JailMonkey Bypass!!!');
console.log("----------------------");

Java.perform(function() {
	var HookDetect = Java.use("com.gantix.JailMonkey.HookDetection.HookDetectionCheck");
	HookDetect.hookDetected.implementation = function() {
		console.log("[+] Hook Detect bypassed!")
		return true;
	}
	HookDetect.advancedHookDetection.implementation = function() {
		console.log("[+] Advanced Hook Detect bypassed!");
		return true;
	}
	HookDetect.checkFrida.implementation = function() {
		console.log("[+] Anti-Frida Bypassed!");
		return false;
	}

	const adb_check = Java.use("com.gantix.JailMonkey.AdbEnabled.AdbEnabled");
	adb_check.AdbEnabled.implementation = function() {
		console.log("[+] AdbEnabled bypassed!!!");
		return false;
	}

	const jail_proc = Java.use("com.gantix.JailMonkey.JailMonkeyModule");
	const hashmap_proc = Java.use("java.util.HashMap");
	const false_obj = Java.use("java.lang.Boolean").FALSE.value;

	jail_proc.getConstants.implementation = function() {
		var h = hashmap_proc.$new();
		h.put("isJailBroken",false_obj);
		h.put("hookDetected", false_obj);
		h.put("canMockLocation",false_obj);
		h.put("isOnExternalStorage",false_obj);
		h.put("AdbEnabled",false_obj);
		return h;
		console.log("[+] JailMonkey Protection bypassed!");
	}

	jail_proc.isDevelopmentSettingsMode.implementation = function() {
		return false;
	}
	jail_proc.isDebbugedMode.implementation = function() {
		return false;
	}
});
